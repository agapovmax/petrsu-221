GAS LISTING task1.S 			page 1


   1              	/*
   2              	   * –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∑–∏—Ü–∏–π —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è
   3              	   * —Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ
   4              	   * 32-–±–∏—Ç–æ–≤–æ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞
   5              	
   6              	   * –ü–æ–≥—Ä–∞–º–º–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–µ task1.
   7              	
   8              	   * –ê—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:  as -ahlsm=task1.lst --32 -gstabs+ -o task1.o task1.S
   9              	   *
  10              	   * -ahlsm –∫–ª—é—á–∏ –ø–æ–ª–Ω–æ–≥–æ –ª–∏—Å—Ç–∏–Ω–≥–∞
  11              	   * task1.lst - –∏–º—è –¢–ï–ö–°–¢–û–í–û–ì–û —Ñ–∞–π–ª–∞ –ª–∏—Å—Ç–∏–Ω–≥–∞, –æ–ø–∏—Å—ã–≤–∞—é—â–µ–≥–æ
  12              	   * —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
  13              	
  14              	   * --32 - –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 32 —Ä–∞–∑—Ä—è–¥–Ω—ã–µ –º–∞—à–∏–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
  15              	
  16              	   * -gstabs+ - –∫–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ç
  17              	
  18              	   * -o task1.o - –∑–∞–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ ( –¥–ª—è –∫–æ–º–∞–Ω–¥—ã as -
  19              	   * –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ) —Ñ–∞–π–ª–∞
  20              	
  21              	   * -o –∫–ª—é—á –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ ( –¥–ª—è –∫–æ–º–∞–Ω–¥—ã as -
  22              	   * –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ) —Ñ–∞–π–ª–∞
  23              	
  24              	   * task1.S -  –∏—Å—Ö–æ–¥–Ω—ã–π -  –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
  25              	   *
  26              	   * –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–µ–π: ld -melf_i386 -o task1-exe-S task1.o
  27              	
  28              	   * –ú–û–ñ–ù–û –ù–ï –ß–ò–¢–ê–¢–¨! –í –Ω–∞—à–µ–º –∫—É—Ä—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ
  29              	   *                -melf_i386
  30              	   *  -m<—ç–º—É–ª—è—Ü–∏—è ld> ld –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥
  31              	   *     –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä.
  32              	   *     –ì–æ–≤–æ—Ä—è—Ç, —á—Ç–æ ld "—ç–º—É–ª–∏—Ä—É–µ—Ç" –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.
  33              	   *  –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã - "—ç–º—É–ª—è—Ü–∏–∏":
  34              	
  35              	   *    elf_x86_64
  36              	   *    elf_i386
  37              	   *    i386linux
  38              	   *    elf_l1om
  39              	
  40              	   * -o task1-exe-S - –∑–∞–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ
  41              	   * (–¥–ª—è –∫–æ–º–∞–Ω–¥—ã ld -  –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ) —Ñ–∞–π–ª–∞
  42              	
  43              	   * -o –∫–ª—é—á –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ
  44              	   * (–¥–ª—è –∫–æ–º–∞–Ω–¥—ã ld -  –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ) —Ñ–∞–π–ª–∞
  45              	
  46              	   * task1.o - –æ–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª (–≤—Ö–æ–¥–Ω–æ–π –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å–≤—è–∑–µ–π l
  47              	
  48              	   * –ó–∞–ø—É—Å–∫ –æ—Ç–ª–∞–¥—á–∏–∫–∞: kdbg task1-exe-S
  49              	   *
  50              	*/
  51              	
  52              	.include "my-macro"  # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
   1              	/* –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã */
   2              	
   3              	.macro Finish
   4              	    movl $0, %ebx 	# first argument: exit code
   5              	    movl $1, %eax 	# sys_exit index
GAS LISTING task1.S 			page 2


   6              	    int  $0x80 		# kernel interrupt
   7              	.endm
   8              	
  53              	
  54              	
  55              	.data     # —Å–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
  56              	          # —Å–æ–æ—Ç–≤. –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —è–∑—ã–∫–∞ C –∏ –∫–æ–º–º–µ–Ω—Ç.
  57 0000 29090000 	n:     .long 2345         # int n = 2345; —á–∏—Å–ª–æ
  58 0004 00000000 	length: .long 0           # int length =0; —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  59 0008 0A000000 	ten:     .long 10         # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –Ø–í–ù–û
  60              	                          # –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ –≤ C
  61              	
  62              	.text # —Å–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞
  63              	
  64              	.global _start     # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ - –≥–ª–æ–±–∞–ª—å–Ω–∞—è –º–µ—Ç–∫–∞
  65              	
  66              	_start:
  67 0000 90       	    nop             # –ø—É—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - no operation
  68              	
  69              	#   –Ω—É–∂–Ω–∞, —á—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å –æ—Ç–ª–∞–¥—á–∏–∫—É –∫–æ–Ω—Ç—Ä. —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ 
  70              	#   —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  71              	
  72 0001 BB000000 	    movl $0, %ebx   # counter = 0; —Å—á–µ—Ç—á–∏–∫ –¥–µ–ª–µ–Ω–∏–π
  72      00
  73 0006 A1000000 	    movl n, %eax    # –≥–æ—Ç–æ–≤–∏–º –∫ –∫–æ–º–∞–Ω–¥–µ –¥–µ–ª–µ–Ω–∏—è idivl
  73      00
  74              	                    # –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ –≤ C
  75              	nextdigit:
  76 000b BA000000 	        movl  $0, %edx          # –µ—â–µ –≥–æ—Ç–æ–≤–∏–º, —É–∂–µ –≤ —Ü–∏–∫–ª–µ
  76      00
  77              	                                # –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ –≤ C
  78              	
  79              	#   –°–º—ã—Å–ª —ç—Ç–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏.
  80              	#   –ü—Ä–∏–º–µ–º, —á—Ç–æ –¥–µ–ª–∏–º 32 –±–∏—Ç–æ–≤–æ–µ —á–∏—Å–ª–æ, —Ä–∞–∑–º–µ—â–Ω–Ω–Ω–æ–µ –≤ EAX.
  81              	#   –¢.–∫. –∫–æ–º–∞–Ω–¥–∞ idivl –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–∞—Ä–µ —Ä–µ–≥–∏—
  82              	#   –∫–∞–∫ –µ–¥–∏–Ω–æ–µ 64 –±–∏—Ç–æ–≤–æ–µ –¥–µ–ª–∏–º–æ–µ, —Ç–æ –ø–µ—Ä–µ–¥ –¥–µ–ª–µ–Ω–∏–µ–º EDX –¥–æ
  83              	#   0.  –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞
  84              	#   –ø–æ–º–µ—â–∞–µ—Ç –≤ EDX - –æ—Å—Ç–∞—Ç–æ–∫, –≤ EAX - —á–∞—Å—Ç–Ω–æ–µ, —á—Ç–æ
  85              	#   –ù–ê–†–£–®–ê–ï–¢ –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Æ –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä—ã EDX,EAX. –ü–µ—Ä–µ–¥ —Å–ª–
  86              	#   –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –Ω–∞–¥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –ø—Ä–∏—Å–≤–æ–∏–≤ EDX –∑–Ω–∞—á–µ–Ω
  87              	
  88 0010 F73D0800 	        idivl ten        # –¥–µ–ª–∏–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã edx:eax –Ω–∞ 10
  88      0000
  89              	                         # —á–∞—Å—Ç–Ω–æ–µ –≤  eax, –æ—Å—Ç–∞—Ç–æ–∫ –≤ edx
  90              	
  91 0016 43       	        incl %ebx        # ++counter; —Å—á–µ—Ç—á–∏–∫ –¥–µ–ª–µ–Ω–∏–π + 1
  92              	
  93              	#    –¥–≤–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—Å–ª–æ–≤–Ω–æ–º—É –æ–ø–µ—
  94              	#    nextdigit;
  95              	
  96 0017 83F800   	        cmpl $0, %eax    # —á–∞—Å—Ç–Ω–æ–µ > 0 ?
  97 001a 7FEF     	        jg   nextdigit   # –î–ê, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
  98              	
  99              	
 100              	/* 
 101              	
 102              	–ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –Ω–∞ –Ø–ö–¶–ü –í–°–ï–ì–î–ê –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–∞—Ä–æ–π –∫–æ–º
GAS LISTING task1.S 			page 3


 103              	
 104              	   cmp <–æ–ø–µ—Ä–∞–Ω–¥1>, <–æ–ø–µ—Ä–∞–Ω–¥2> - –≤—ã–ø. –≤—ã—á–∏—Ç–∞–Ω–∏–µ <–æ–ø–µ—Ä–∞–Ω–¥2>-<–æ–ø–µ—
 105              	                          - –æ—Ç—Ä–∞–∂–∞–µ—Ç –∑–Ω–∞–∫ –∏ –¥—Ä. —Å–≤–æ–π—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–
 106              	                            –≤ –±–∏—Ç–∞—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Ñ–ª–∞–≥–æ–≤.
 107              	
 108              	   jcc <–æ–ø–µ—Ä–∞–Ω–¥> - j[ump on] c[ondition] c[ode] –ø—Ä–æ–≤–µ—Ä—è–µ—Ç
 109              	          —É—Å–ª–æ–≤–∏–µ –≤ –±–∏—Ç–∞—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Ñ–ª–∞–≥–æ–≤ –∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –
 110              	          –≤—ã–ø–æ–ª–Ω—è–µ—Ç/–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥  –ø–æ –∞–¥—Ä–µ—Å—É <–æ–ø–µ—Ä–∞–
 111              	
 112              	 –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∫–æ–º–∞–Ω–¥–∞ jg   nextdigit { jg - jump if greater
 113              	- –ø–µ—Ä–µ–π—Ç–∏ –µ—Å–ª–∏ —Å—Ç—Ä–æ–≥–æ  –±–æ–ª—å—à–µ} –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–µ—Ç
 114              	nextdigit: –µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –∫–æ–º–∞–Ω–¥–∞ cmpl $0, %eax —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∞ –≤
 115              	—Ä–µ–≥–∏—Å—Ç—Ä–µ —Ñ–ª–∞–≥–æ–≤ –±–∏—Ç—ã, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ä–µ–≥–∏
 116              	—Ç.–µ. —á–∞—Å—Ç–Ω–æ–µ, –°–¢–†–û–ì–û  –ë–û–õ–¨–®–ï –Ω—É–ª—è.
 117              	
 118              	*/
 119              	
 120 001c 891D0400 	        movl %ebx, length  # length = counter; –î–ê,—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
 120      0000
 121              	
 122              	    Finish                 # –∫–æ–Ω–µ—Ü —Ä–∞–±–æ—Ç—ã,
 122 0022 BB000000 	>  movl $0,%ebx
 122      00
 122 0027 B8010000 	>  movl $1,%eax
 122      00
 122 002c CD80     	>  int $0x80
 123              	                           # –≤–æ–∑–≤—Ä–∞—Ç –≤ –û–°
 124              	                           # (–º–∞–∫—Ä–æ –∏–∑ —Ñ–∞–π–ª–∞ my-macro)
 125              	
 126              	.end   # –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
GAS LISTING task1.S 			page 4


DEFINED SYMBOLS
             task1.S:57     .data:00000000 n
             task1.S:58     .data:00000004 length
             task1.S:59     .data:00000008 ten
             task1.S:66     .text:00000000 _start
             task1.S:75     .text:0000000b nextdigit

NO UNDEFINED SYMBOLS
