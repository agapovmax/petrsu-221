GAS LISTING task3-beta.S 			page 1


   1              	/*
   2              	 * ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ²Ğ²Ğ¾Ğ´Ğ° ĞºĞ¾Ğ´Ğ¾Ğ² Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ñ… ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ² Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ² ĞĞŸ
   3              	 * Ğ§Ñ‚Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ»:
   4              	 * - Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ¶Ğ°Ñ‚Ğ¸Ğ¸ Enter Ğ² EAX Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ 
   5              	 * - Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµÑ‚ ÑĞ²Ğ¾Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ñ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ĞµĞ¼ Ğ¾ Ğ·Ğ°Ğ²Ğ
   6              	 */
   7              	
   8              	.include "my-macro"
   1              	/*
   2              	 * ĞœĞ°ĞºÑ€Ğ¾Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹.
   3              	 * ĞÑ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹:
   4              	 *     - ĞºĞ¾Ğ´ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
   5              	 *
   6              	 * ĞŸĞ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¼Ğ°ĞºÑ€Ğ¾Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹: %e
   7              	 * Ğ¡Ğ¼. Ñ‚Ğ°ĞºĞ¶Ğµ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	    movl $1, %eax         # Ğ½Ğ¾Ğ¼ĞµÑ€ ÑĞ¸ÑÑ‚. Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° exit
  11              	    movl \ret_val, %ebx     # ĞºĞ¾Ğ´ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ°
  12              	    int $0x80         # Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ·Ğ¾Ğ²
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * ĞœĞ°ĞºÑ€Ğ¾Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ±Ğ°Ğ¹Ñ‚Ğ° ĞºĞ¾Ğ´Ğ° Ñ
  18              	 * ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ°
  19              	 * ĞĞµĞºĞ°Ñ Ğ°Ğ±ÑÑ‚Ñ€Ğ°ĞºÑ†Ğ¸Ñ Ğ½Ğ°Ğ´ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¼ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ¼ Linux read, Ğ¿Ñ€ĞµĞ´Ğ½Ğ
  20              	 * ĞÑ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹:
  21              	 *     - Ğ°Ğ´Ñ€ĞµÑ Ğ±ÑƒÑ„ĞµÑ€Ğ° Ğ´Ğ»Ñ ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ Ğ±Ğ°Ğ¹Ñ‚Ğ°
  22              	 * Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
  23              	 *    - Ğ² %eax ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ¹Ñ‚Ğ¾Ğ²
  24              	 *    - Ğ¿Ğ¾ Ğ°Ğ´Ñ€ĞµÑÑƒ buf_addr - ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ±Ğ°Ğ¹Ñ‚
  25              	 *
  26              	 * ĞŸĞ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¼Ğ°ĞºÑ€Ğ¾Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹: %e
  27              	 * Ğ¡Ğ¼. Ñ‚Ğ°ĞºĞ¶Ğµ 'man 2 read'
  28              	*/
  29              	.macro Getchar buf_addr
  30              	    movl $3, %eax        # Ğ½Ğ¾Ğ¼ĞµÑ€ ÑĞ¸ÑÑ‚. Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° read
  31              	    movl $0, %ebx        # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ 1: Ğ´ĞµÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ñ€ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾
  32              	    movl \buf_addr, %ecx    # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ 2: Ğ°Ğ´Ñ€ĞµÑ Ğ±ÑƒÑ„ĞµÑ€Ğ° (Ğ¾Ğ½ Ğ¶Ğµ - Ñ„Ğ°ĞºÑ‚Ğ¸Ñ‡
  33              	                     # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ Ğ¼Ğ°ĞºÑ€Ğ¾Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ°)
  34              	    movl $1, %edx        # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ 3: ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ±Ğ°Ğ¹Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ
  35              	    int $0x80        # Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ·Ğ¾Ğ²
  36              	.endm
  37              	
  38              	/*
  39              	 * ĞœĞ°ĞºÑ€Ğ¾Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ  Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ² Ñ„Ğ°Ğ¹Ğ» ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ
  40              	 * ĞÑ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹:
  41              	 *     - Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ° Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°.
  42              	 *
  43              	 * ĞŸÑ€Ğ¸Ğ¼ĞµÑ‚Ñ€ Ğ¼Ğ°ĞºÑ€Ğ¾Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ°:
  44              	 *    Puts "Ğ¢ĞµĞºÑÑ‚ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸"
  45              	 *
  46              	 * Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
  47              	 *    - Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ Ğ² ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ²Ğ¾Ğ´ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ
  48              	 *      Ğ¸ Ğ²ÑĞ»ĞµĞ´ Ğ·Ğ° Ğ½Ğ¸Ğ¼Ğ¸ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸ \n
  49              	 *
GAS LISTING task3-beta.S 			page 2


  50              	 * ĞŸĞ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¼Ğ°ĞºÑ€Ğ¾Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹: %e
  51              	 * Ğ¡Ğ¼. Ñ‚Ğ°ĞºĞ¶Ğµ 'man puts', 'man 2 write'
  52              	*/
  53              	.macro Puts string
  54              	.data
  55              	    str\@:     .ascii "\string\n"  # Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ
  56              	
  57              	    strlen\@ =     . - str\@           # Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ğ¸Ğ½Ñ‹ ÑÑ‚Ñ€Ğ¾ĞºĞ
  58              	
  59              	.text
  60              	    movl $4, %eax        # Ğ½Ğ¾Ğ¼ĞµÑ€ ÑĞ¸ÑÑ‚. Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° write
  61              	    movl $1, %ebx        # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ 1: Ğ´ĞµÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ñ€ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ²
  62              	    movl $str\@, %ecx    # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ 2: Ğ°Ğ´Ñ€ĞµÑ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğ¼Ğ¸ ÑĞ¸
  63              	    movl $strlen\@, %edx     # Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ 3: ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ±Ğ°Ğ¹Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ
  64              	    int $0x80        # Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ·Ğ¾Ğ²
  65              	.endm
   9              	
  10              	.bss
  11              	    .lcomm buf, 10 # 10 Ğ±Ğ°Ğ¹Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ±ÑƒÑ„ĞµÑ€ Ğ´Ğ»Ñ ĞºĞ¾Ğ´Ğ¾Ğ² Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ñ… ÑĞ¸Ğ¼
  12              	    .lcomm c, 1    # Ğ¾Ğ´Ğ½Ğ¾Ğ±Ğ°Ğ¹Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ±ÑƒÑ„ĞµÑ€ Ğ´Ğ»Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ Ğ±Ğ°Ğ¹Ñ‚Ğ° Ğ¸Ğ· Ñ„Ğ°Ğ¹
  13              	
  14              	.text
  15              	.global _start
  16              	
  17              	_start:
  18 0000 29F6     	    sub    %esi, %esi     # ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒ Ğ°Ğ´Ñ€ĞµÑĞ° Ğ±Ğ°Ğ¹Ñ‚Ğ° Ğ² Ğ±ÑƒÑ„ĞµÑ€Ğµ buf (Ğ¸Ğ½Ğ´Ğ
  19 0002 BB000000 	    movl   $0, %ebx       # EBX Ğ±ÑƒĞ´ĞµÑ‚ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ
  19      00
  20              	
  21              	show_prompt:
  22              	    Puts "Ğ’Ğ²Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ñ†Ğ¸Ñ„Ñ€Ñƒ, Ğ´Ñ€ÑƒĞ³ Ğ¼Ğ¾Ğ¹! (Enter Ğ´Ğ»Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ²Ğ²Ğ¾Ğ´Ğ°
  22              	> .data
  22 0000 D092D0B2 	>  str0:.ascii "Ğ’Ğ²Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ñ†Ğ¸Ñ„Ñ€Ñƒ, Ğ´Ñ€ÑƒĞ³ Ğ¼Ğ¾Ğ¹! (Enter Ğ´Ğ»Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ²Ğ²Ğ¾Ğ´Ğ°)\n"
  22      D0BED0B4 
  22      D0B8D182 
  22      D0B520D1 
  22      86D0B8D1 
  22              	> 
  22              	>  strlen0 =. - str0
  22              	> 
  22              	> .text
  22 0007 B8040000 	>  movl $4,%eax
  22      00
  22 000c BB010000 	>  movl $1,%ebx
  22      00
  22 0011 B9000000 	>  movl $str0,%ecx
  22      00
  22 0016 BA5B0000 	>  movl $strlen0,%edx
  22      00
  22 001b CD80     	>  int $0x80
  23              	
  24              	kbd_input:
  25              	    Getchar $c          # Ğ¼Ğ°ĞºÑ€Ğ¾Ğ²Ñ‹Ğ·Ğ¾Ğ² Ğ²Ğ²Ğ¾Ğ´Ğ° Ğ±Ğ°Ğ¹Ñ‚Ğ° Ğ¸Ğ· stdin Ğ² Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚
  25 001d B8030000 	>  movl $3,%eax
  25      00
  25 0022 BB000000 	>  movl $0,%ebx
  25      00
GAS LISTING task3-beta.S 			page 3


  25 0027 B90A0000 	>  movl $c,%ecx
  25      00
  25              	>  
  25 002c BA010000 	>  movl $1,%edx
  25      00
  25 0031 CD80     	>  int $0x80
  26              	
  27 0033 83F800   	    cmpl $0, %eax       # Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ¸Ğ»Ğ¾ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ EOF (ĞºĞ¾Ğ½ĞµÑ† Ñ„Ğ°Ğ¹Ğ»Ğ° stdin) ?
  28 0036 0F84E200 	    je stop             # Ğ”Ğ° - Ğ½Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
  28      0000
  29              	
  30 003c 803D0A00 	    cmpb $'\n', c       # ÑÑ‚Ğ¾ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸ ?
  30      00000A
  31 0043 7440     	    je process_enter    # Ğ”Ğ - Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ½Ğ°Ğ¶Ğ°Ñ‚Ğ¸Ğµ Enter
  32              	
  33 0045 803D0A00 	    cmpb $'9', c        # ĞºĞ¾Ğ´ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ĞºĞ¾Ğ´Ğ° ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ° '9' ?
  33      000039
  34 004c 7763     	    ja print_err_msg    # Ğ”Ğ - Ğ½Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
  35 004e 803D0A00 	    cmpb $'0', c        # ĞºĞ¾Ğ´ Ğ¼ĞµĞ½ÑŒÑˆĞµ ĞºĞ¾Ğ´Ğ° ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ° '0' ?
  35      000030
  36 0055 725A     	    jb print_err_msg    # Ğ”Ğ - Ğ½Ğ° Ğ²Ñ‹Ğ²Ğ¾Ğ´ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
  37              	
  38              	    # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ASCII-ĞºĞ¾Ğ´ Ğ² Ğ±ÑƒÑ„ĞµÑ€
  39 0057 A00A0000 	    movb c, %al         # Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ´ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ° Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ¸Ğ· c Ğ² al
  39      00
  40 005c 88860000 	    movb %al, buf(%esi) # Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ´ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ° Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ¸Ğ· al Ğ² Ğ±Ğ°Ğ¹Ñ‚ Ğ±Ñ
  40      0000
  41 0062 46       	    incl %esi           # ÑƒĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ½Ğ° ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ±Ğ°Ğ¹Ñ‚ Ğ±ÑƒÑ„ĞµÑ€Ğ° Ğ´Ğ»Ñ ÑĞ»Ğ
  42              	
  43              	    # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ§Ğ˜Ğ¡Ğ›ĞĞ’ĞĞ• Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ² EBX
  44 0063 A00A0000 	    movb c, %al         # AL = ASCII ĞºĞ¾Ğ´ Ñ†Ğ¸Ñ„Ñ€Ñ‹ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, '3' = 51)
  44      00
  45 0068 2C30     	    subb $'0', %al      # AL = Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ´ - 0 (48) Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ (
  46 006a 0FBED8   	    movsbl %al, %ebx    # EBX = Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ñ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸ĞµĞ¼ Ğ·Ğ½Ğ°Ğ
  47              	
  48              	    Puts "Ğ¦Ğ¸Ñ„Ñ€Ğ°! Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾." # ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ± ÑƒÑĞ¿ĞµÑ…Ğµ Ğ²Ğ²Ğ¾Ğ´Ğµ
  48              	> .data
  48 005b D0A6D0B8 	>  str2:.ascii "Ğ¦Ğ¸Ñ„Ñ€Ğ°! Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾.\n"
  48      D184D180 
  48      D0B02120 
  48      D0A5D0BE 
  48      D180D0BE 
  48              	> 
  48              	>  strlen2 =. - str2
  48              	> 
  48              	> .text
  48 006d B8040000 	>  movl $4,%eax
  48      00
  48 0072 BB010000 	>  movl $1,%ebx
  48      00
  48 0077 B95B0000 	>  movl $str2,%ecx
  48      00
  48 007c BA1A0000 	>  movl $strlen2,%edx
  48      00
  48 0081 CD80     	>  int $0x80
  49              	
  50 0083 EB82     	    jmp show_prompt     # Ğ½Ğ° Ğ²Ğ²Ğ¾Ğ´ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ°
GAS LISTING task3-beta.S 			page 4


  51              	
  52              	process_enter:
  53              	    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ğ±Ñ‹Ğ»Ğ° Ğ»Ğ¸ Ğ²Ğ²ĞµĞ´ĞµĞ½Ğ° Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¾Ğ´Ğ½Ğ° Ñ†Ğ¸Ñ„Ñ€Ğ°
  54 0085 83FE00   	    cmpl $0, %esi
  55 0088 740C     	    je no_digits_error
  56              	
  57              	    # ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ¹ Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ¸Ğ· EBX Ğ² 
  58 008a 89D8     	    movl %ebx, %eax      # EAX = Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ¹ Ñ†Ğ¸Ñ„Ñ€Ñ‹
  59              	
  60              	    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
  61 008c E83B0000 	    call print_result
  61      00
  62              	
  63              	    # ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾ (Ğ¾Ñ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ)
  64 0091 E96AFFFF 	    jmp _start
  64      FF
  65              	
  66              	no_digits_error:
  67              	    Puts "Ğ’Ñ‹ Ğ½Ğµ Ğ²Ğ²ĞµĞ»Ğ¸ Ğ½Ğ¸ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ†Ğ¸Ñ„Ñ€Ñ‹! ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ†Ğ
  67              	> .data
  67 0075 D092D18B 	>  str3:.ascii "Ğ’Ñ‹ Ğ½Ğµ Ğ²Ğ²ĞµĞ»Ğ¸ Ğ½Ğ¸ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ†Ğ¸Ñ„Ñ€Ñ‹! ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ†Ğ¸Ñ„Ñ€Ñƒ.\n"
  67      20D0BDD0 
  67      B520D0B2 
  67      D0B2D0B5 
  67      D0BBD0B8 
  67              	> 
  67              	>  strlen3 =. - str3
  67              	> 
  67              	> .text
  67 0096 B8040000 	>  movl $4,%eax
  67      00
  67 009b BB010000 	>  movl $1,%ebx
  67      00
  67 00a0 B9750000 	>  movl $str3,%ecx
  67      00
  67 00a5 BA620000 	>  movl $strlen3,%edx
  67      00
  67 00aa CD80     	>  int $0x80
  68 00ac E956FFFF 	    jmp show_prompt
  68      FF
  69              	
  70              	print_err_msg:
  71              	    Puts "ĞĞµ Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ ĞºĞ»Ğ°Ğ²Ğ¸ÑˆĞ°. ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚Ğµ Ğ²Ğ²Ğ¾Ğ´"    # Ğ²Ñ‹Ğ²Ğ¾Ğ´ ÑĞ¾Ğ¾
  71              	> .data
  71 00d7 D09DD0B5 	>  str4:.ascii "ĞĞµ Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ ĞºĞ»Ğ°Ğ²Ğ¸ÑˆĞ°. ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚Ğµ Ğ²Ğ²Ğ¾Ğ´\n"
  71      20D186D0 
  71      B8D184D1 
  71      80D0BED0 
  71      B2D0B0D1 
  71              	> 
  71              	>  strlen4 =. - str4
  71              	> 
  71              	> .text
  71 00b1 B8040000 	>  movl $4,%eax
  71      00
  71 00b6 BB010000 	>  movl $1,%ebx
  71      00
GAS LISTING task3-beta.S 			page 5


  71 00bb B9D70000 	>  movl $str4,%ecx
  71      00
  71 00c0 BA420000 	>  movl $strlen4,%edx
  71      00
  71 00c5 CD80     	>  int $0x80
  72 00c7 E93BFFFF 	    jmp show_prompt                               # Ğ½Ğ° Ğ²Ğ²Ğ¾Ğ´ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»
  72      FF
  73              	
  74              	print_result:
  75              	    # Ğ’Ğ¾Ğ¾Ğ±Ñ‰Ğµ, Ñ…Ğ¾Ñ‡ĞµÑ‚ÑÑ ÑÑ‚Ğ¾ Ğ¿ĞµÑ€ĞµĞ½ĞµÑÑ‚Ğ¸ Ğ² my-macro
  76              	    # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹ Ğ² ÑÑ‚ĞµĞº Ñ‚Ğ°Ğº ĞºĞ°Ğº Ğ¼Ñ‹ Ğ
  77              	    # ĞÑ‡ĞµĞ½ÑŒ Ğ²Ğ°Ğ¶ĞµĞ½ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ñ†Ğ¸Ğ¿Ñ‹ LILO
  78 00cc 50       	    pushl %eax
  79 00cd 53       	    pushl %ebx
  80 00ce 51       	    pushl %ecx
  81 00cf 52       	    pushl %edx
  82              	
  83              	    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
  84              	    Puts "Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ (Ğ² Ğ´ĞµÑÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğµ): "
  84              	> .data
  84 0119 D097D0BD 	>  str5:.ascii "Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ (Ğ² Ğ´ĞµÑÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğµ): \n"
  84      D0B0D187 
  84      D0B5D0BD 
  84      D0B8D0B5 
  84      2028D0B2 
  84              	> 
  84              	>  strlen5 =. - str5
  84              	> 
  84              	> .text
  84 00d0 B8040000 	>  movl $4,%eax
  84      00
  84 00d5 BB010000 	>  movl $1,%ebx
  84      00
  84 00da B9190100 	>  movl $str5,%ecx
  84      00
  84 00df BA3C0000 	>  movl $strlen5,%edx
  84      00
  84 00e4 CD80     	>  int $0x80
  85              	
  86              	    # ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµĞ¼ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¸Ğ· EAX Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾ Ğ² ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°
  87 00e6 0430     	    addb $'0', %al      # %al = ASCII ĞºĞ¾Ğ´ Ñ†Ğ¸Ñ„Ñ€Ñ‹. ĞŸÑ€Ğ¸Ğ±Ğ°Ğ²Ğ¸Ğ¼ ĞºĞ¾Ğ´ Ğ½ÑƒĞ»Ñ - 48 Ğº Ñ
  88 00e8 A20A0000 	    movb %al, c         # ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ 51 Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°
  88      00
  89              	
  90              	    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ ÑĞ°Ğ¼Ñƒ Ñ†Ğ¸Ñ„Ñ€Ñƒ
  91 00ed B8040000 	    movl $4, %eax       # ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ·Ğ¾Ğ² write
  91      00
  92 00f2 BB010000 	    movl $1, %ebx       # Ğ²Ñ‹Ğ²Ğ¾Ğ´ stdout
  92      00
  93 00f7 B90A0000 	    movl $c, %ecx       # Ğ°Ğ´Ñ€ĞµÑ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ°
  93      00
  94 00fc BA010000 	    movl $1, %edx       # Ğ´Ğ»Ğ¸Ğ½Ğ° (1 Ğ±Ğ°Ğ¹Ñ‚)
  94      00
  95 0101 CD80     	    int $0x80
  96              	
  97              	    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
  98              	    Puts ""
GAS LISTING task3-beta.S 			page 6


  98              	> .data
  98 0155 0A       	>  str6:.ascii "\n"
  98              	> 
  98              	>  strlen6 =. - str6
  98              	> 
  98              	> .text
  98 0103 B8040000 	>  movl $4,%eax
  98      00
  98 0108 BB010000 	>  movl $1,%ebx
  98      00
  98 010d B9550100 	>  movl $str6,%ecx
  98      00
  98 0112 BA010000 	>  movl $strlen6,%edx
  98      00
  98 0117 CD80     	>  int $0x80
  99              	
 100              	    # Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹ Ğ¸Ğ· ÑÑ‚ĞµĞºĞ°
 101 0119 5A       	    popl %edx
 102 011a 59       	    popl %ecx
 103 011b 5B       	    popl %ebx
 104 011c 58       	    popl %eax
 105              	
 106 011d C3       	    ret                 # Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ¸Ğ· Ğ¿Ğ¾Ğ´Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
 107              	
 108              	stop:
 109              	    # ĞŸĞµÑ€ĞµĞ´ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸ĞµĞ¼ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ² EAX (Ğ¾Ğ¿Ñ†Ğ¸
 110              	    # cmpl $0, %esi       # ĞµÑĞ»Ğ¸ Ğ±Ñ‹Ğ»Ğ¸ Ğ²Ğ²ĞµĞ´ĞµĞ½Ñ‹ Ñ†Ğ¸Ñ„Ñ€Ñ‹
 111              	    # jne print_final_value
 112              	
 113              	    Exit $0
 113 011e B8010000 	>  movl $1,%eax
 113      00
 113 0123 BB000000 	>  movl $0,%ebx
 113      00
 113 0128 CD80     	>  int $0x80
 114              	
 115              	print_final_value:
 116              	    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ´ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ¾Ğ¼
 117 012a E89DFFFF 	    call print_result
 117      FF
 118              	    Exit $0
 118 012f B8010000 	>  movl $1,%eax
 118      00
 118 0134 BB000000 	>  movl $0,%ebx
 118      00
 118 0139 CD80     	>  int $0x80
 119              	
 120              	.end
GAS LISTING task3-beta.S 			page 7


DEFINED SYMBOLS
        task3-beta.S:11     .bss:00000000 buf
        task3-beta.S:11     .bss:0000000a c
        task3-beta.S:17     .text:00000000 _start
        task3-beta.S:21     .text:00000007 show_prompt
        task3-beta.S:22     .data:00000000 str0
        task3-beta.S:22     *ABS*:0000005b strlen0
        task3-beta.S:24     .text:0000001d kbd_input
        task3-beta.S:108    .text:0000011e stop
        task3-beta.S:52     .text:00000085 process_enter
        task3-beta.S:70     .text:000000b1 print_err_msg
        task3-beta.S:48     .data:0000005b str2
        task3-beta.S:48     *ABS*:0000001a strlen2
        task3-beta.S:66     .text:00000096 no_digits_error
        task3-beta.S:74     .text:000000cc print_result
        task3-beta.S:67     .data:00000075 str3
        task3-beta.S:67     *ABS*:00000062 strlen3
        task3-beta.S:71     .data:000000d7 str4
        task3-beta.S:71     *ABS*:00000042 strlen4
        task3-beta.S:84     .data:00000119 str5
        task3-beta.S:84     *ABS*:0000003c strlen5
        task3-beta.S:98     .data:00000155 str6
        task3-beta.S:98     *ABS*:00000001 strlen6
        task3-beta.S:115    .text:0000012a print_final_value

NO UNDEFINED SYMBOLS
